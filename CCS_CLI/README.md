# CCS CLI (CharacterCard Studio)

> **The Engine Room for your SillyTavern Projects.**

CCS CLI æ˜¯ä¸€ä¸ªä¸“ä¸º SillyTavern å†…å®¹åˆ›ä½œè€…è®¾è®¡çš„å‘½ä»¤è¡Œå·¥å…·ã€‚å®ƒå°†ä½ çš„æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿè½¬å˜ä¸ºä¸€ä¸ªå¼ºå¤§çš„å¼€å‘ç¯å¢ƒï¼Œæ”¯æŒè§’è‰²å¡ (Character) å’Œä¸–ç•Œä¹¦ (Worldbook) çš„å·¥ç¨‹åŒ–ç®¡ç†ã€‚

## ğŸ“¦ å®‰è£… (Installation)

### å‰ç½®è¦æ±‚
*   Node.js (v18 æˆ–æ›´é«˜ç‰ˆæœ¬)
*   SillyTavern å·²å¯åŠ¨å¹¶è¿è¡Œ (é»˜è®¤ http://127.0.0.1:8000)

### æºç å®‰è£…
```bash
# 1. è¿›å…¥ CLI ç›®å½•
cd CCS_CLI

# 2. å®‰è£…ä¾èµ–
npm install

# 3. æ„å»ºé¡¹ç›® (åŸºäº tsupï¼Œé€Ÿåº¦é£å¿«)
npm run build 

# 4. å…¨å±€é“¾æ¥ (å¯èƒ½éœ€è¦ sudo)
# è¿™ä¸€æ­¥ä¼šå°† 'st' å‘½ä»¤æ³¨å†Œåˆ°ä½ çš„ç³»ç»Ÿè·¯å¾„ä¸­
sudo npm link
```

éªŒè¯å®‰è£…ï¼š
```bash
st --version
# Should output 1.0.0
```

## âš™ï¸ é…ç½® (Configuration)

è¯¥å·¥å…·æ”¯æŒ **é›¶é…ç½®å¯åŠ¨** (Zero Config)ï¼Œä½†ä½ ä¹Ÿå¯ä»¥æ˜¾å¼é…ç½® API åœ°å€ã€‚

é…ç½®åŠ è½½ä¼˜å…ˆçº§ï¼ˆç”±é«˜åˆ°ä½ï¼‰ï¼š
1.  **ç¯å¢ƒå˜é‡**: `ST_API_URL`
2.  **é…ç½®æ–‡ä»¶**: `sillytavern.config.yaml` (æ¨è)
3.  **é…ç½®æ–‡ä»¶**: `.env`
4.  **é»˜è®¤å€¼**: `http://127.0.0.1:8000`

### æ™ºèƒ½å±‚çº§æŸ¥æ‰¾
ä½ å¯ä»¥åœ¨é¡¹ç›®çš„ä»»ä½•å­ç›®å½•æ‰§è¡Œ `st` å‘½ä»¤ã€‚å·¥å…·ä¼š**å‘ä¸Šé€’å½’æŸ¥æ‰¾**é…ç½®æ–‡ä»¶ï¼Œç›´åˆ°æ‰¾åˆ°ä¸ºæ­¢ã€‚

**ç¤ºä¾‹ `sillytavern.config.yaml`**:
```yaml
# é¡¹ç›®ç±»å‹: 'character' æˆ– 'worldbook'
mode: character

# API åœ°å€
apiUrl: http://192.168.1.100:8000

# (å¯é€‰) API Key
apiKey: "your-api-key"
```

## ğŸ› ï¸ æ ¸å¿ƒå‘½ä»¤ (Commands)

### 1. åˆå§‹åŒ–é¡¹ç›®
å¿«é€Ÿåˆ›å»ºä¸€ä¸ªæ–°çš„é¡¹ç›®ç»“æ„ã€‚

```bash
# åˆå§‹åŒ–ä¸€ä¸ªä¸–ç•Œä¹¦é¡¹ç›®
st init MyFantasyWorld

# åˆå§‹åŒ–ä¸€ä¸ªè§’è‰²é¡¹ç›®
st init Seraphina
```

### 2. å…‹éš† (Clone)
ä»é…’é¦†é‡ŒæŠŠç°æœ‰çš„å†…å®¹â€œæŠ“â€ä¸‹æ¥ï¼Œå¹¶è‡ªåŠ¨æ‹†è§£ä¸ºå¯ç¼–è¾‘çš„æ–‡ä»¶ã€‚

```bash
# å…‹éš†è§’è‰² (è‡ªåŠ¨æ‹†åˆ†ä¸º YAML + Markdown)
st clone Seraphina --type character

# å…‹éš†ä¸–ç•Œä¹¦ (è‡ªåŠ¨æ‹†åˆ†ä¸º entries/*.yaml)
st clone "Generic Fantasy" --type worldbook
```

### 3. æ¨é€ (Push)
å°†æœ¬åœ°çš„ä¿®æ”¹åŒæ­¥å›é…’é¦†ã€‚

```bash
# åœ¨é¡¹ç›®æ ¹ç›®å½•æˆ–å­ç›®å½•æ‰§è¡Œ
st push
```

### 4. æ‹‰å– (Pull)
å½“ä½ åœ¨é…’é¦†ç½‘é¡µç‰ˆåšäº†ä¿®æ”¹ï¼ˆæ¯”å¦‚å¾®è°ƒäº†å¤´åƒæˆ–å‚æ•°ï¼‰ï¼Œç”¨è¿™ä¸ªå‘½ä»¤æ‹‰å–å›æœ¬åœ°ã€‚

```bash
# è­¦å‘Šï¼šä¼šè¦†ç›–æœ¬åœ°æ–‡ä»¶
st pull
```

### 5. ç›‘å¬ (Watch)
å¼€å‘æ¨¡å¼ã€‚ç±»ä¼¼å‰ç«¯å¼€å‘çš„ HMR (çƒ­æ›´æ–°)ã€‚ä¿å­˜æ–‡ä»¶ç«‹åˆ»ç”Ÿæ•ˆã€‚

```bash
st watch
```

## ğŸ¤– MCP Server é›†æˆ (æ¨è)

æœ¬å·¥å…·é‡‡ç”¨äº† **CLI + MCP Server** çš„æ··åˆæ¶æ„ã€‚è¿™æ„å‘³ç€å®ƒä¸ä»…æ˜¯ä¸€ä¸ªå‘½ä»¤è¡Œå·¥å…·ï¼Œè¿˜æ˜¯ä¸€ä¸ªå¼ºå¤§çš„åå°æœåŠ¡ï¼Œèƒ½è®© AI (å¦‚ Claude/Cursor) ç›´æ¥æ„ŸçŸ¥å’Œæ“ä½œä½ çš„é¡¹ç›®ã€‚

### ğŸš€ å¯åŠ¨æ–¹å¼ (æ¨è SSE æ¨¡å¼)

æˆ‘ä»¬å¼ºçƒˆå»ºè®®ä½¿ç”¨ **SSE (Server-Sent Events)** æ¨¡å¼ã€‚
ç›¸æ¯”ä¼ ç»Ÿçš„ Stdio æ¨¡å¼ï¼ŒSSE æ¨¡å¼å®Œå…¨è§£è€¦ï¼Œæ”¯æŒè¿œç¨‹è¿æ¥ï¼Œä¸”æ—¥å¿—è¾“å‡ºæ›´æ¸…æ™°ï¼Œæ–¹ä¾¿è°ƒè¯•ã€‚

```bash
# å¯åŠ¨æ ‡å‡† SSE æœåŠ¡ (é»˜è®¤ç«¯å£ 3000)
# ç”Ÿäº§ç¯å¢ƒæ¨è
npm run mcp 

# æˆ–è€…ç”¨äºå¼€å‘ (æ”¯æŒçƒ­é‡è½½ HMR)
npm run dev:sse
```

å¯åŠ¨æˆåŠŸåï¼Œä½ å°†è·å¾—ä¸€ä¸ª HTTP ç«¯ç‚¹ï¼š`http://localhost:3000/sse`

### Client é…ç½®

è¯·ç¼–è¾‘ä½ çš„ MCP é…ç½®æ–‡ä»¶ï¼ˆå¦‚ `~/Library/Application Support/Claude/claude_desktop_config.json`ï¼‰ï¼Œæ·»åŠ å¦‚ä¸‹å†…å®¹ï¼š

```json
{
  "mcpServers": {
    "ccs-unified": {
      "url": "http://localhost:3000/sse"
    }
  }
}
```

> **ä¼ ç»Ÿ Stdio æ¨¡å¼**:
> å¦‚æœä½ ä»ç„¶åå¥½ç”± IDE ç®¡ç†è¿›ç¨‹ï¼Œå¯ä»¥ä½¿ç”¨æ—§é…ç½®ï¼š
> `"command": "node", "args": ["/absolute/path/to/CCS_CLI/dist/index.js", "mcp"]`


---

## ç›®å½•ç»“æ„å‚è€ƒ

### Character é¡¹ç›®
```text
/MyChar/
â”œâ”€â”€ character.yaml      # æ ¸å¿ƒæ•°å€¼
â”œâ”€â”€ first_message.md    # å¼€åœºç™½
â”œâ”€â”€ description.md      # è¯¦ç»†è®¾å®š
â”œâ”€â”€ linked_worldbooks/  # ç»‘å®šä¸–ç•Œä¹¦
â””â”€â”€ sillytavern.config.yaml
```

### Worldbook é¡¹ç›®
```text
/MyLore/
â”œâ”€â”€ index.yaml          # æ’åºç´¢å¼•
â”œâ”€â”€ entries/            # æ¡ç›®æºæ–‡ä»¶
â”‚   â”œâ”€â”€ entry1.yaml
â”‚   â””â”€â”€ entry2.yaml
â””â”€â”€ sillytavern.config.yaml
```
